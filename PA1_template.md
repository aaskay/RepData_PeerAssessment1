---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```r
activityData <- read.csv(file="activity.csv",header=TRUE,na.strings = "NA")
activityData$date <- as.Date(activityData$date)
```
## What is mean total number of steps taken per day?

1. Calculate the total number of steps taken per day ignoring missing values.


```r
activityData_NoNA <- activityData[complete.cases(activityData),]
totalStepsPerDay <- aggregate(steps~date,activityData_NoNA,sum)
```

2. Look at a histogram of the total number of steps per day.  


```r
hist(totalStepsPerDay$steps,main = 'Total Steps Per Day',xlab = 'Total Steps',col = 'blue',border = 'orange')
```

![](PA1_template_files/figure-html/histogram-1.png)<!-- -->

3. Calculate and report the mean and median of the total number of steps taken per day


```r
options(scipen = 5,digits = 2)
mean_totalStepsPerDay <- mean(totalStepsPerDay$steps)
median_totalStepsPerDay <- median(totalStepsPerDay$steps)
```
The mean of the total steps taken per day is: 10766.19.  
The median of the total steps taken per day is: 10765.

## What is the average daily activity pattern?

1. Make a time series plot of the 5-minute intervals versus the average number of steps taken.


```r
df <- NULL
df$Interval = unique(activityData_NoNA$interval)
df2 <- aggregate(steps~interval,activityData_NoNA,mean)
df$AvgStepsPerInterval <- df2$steps
df <- as.data.frame(df)
```


```r
plot(df$Interval,df$AvgStepsPerInterval,type = 'l',xlab = 'Interval',ylab = 'Average steps taken')
```

![](PA1_template_files/figure-html/Plot_IntervalVsAvgSteps-1.png)<!-- -->

2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?


```r
maxStepInterval <- df$Interval[which.max(df$AvgStepsPerInterval)]
```

The 5-minute interval with the maximum number of steps is: 835.

## Imputing missing values

1. Calculate and report the total number of missing values in the dataset.


```r
nbrNA <- sum(rowSums(is.na(activityData)))
```

The data set contains 2304 rows with missing values.  

2. Fill in all of the missing values in the dataset by using the mean for that 5-minute interval.  
  
3. Create a new data set that is equal to the original but with missing data filled in.  


```r
ad <- activityData
ad$steps <- ifelse(is.na(ad$steps),df$AvgStepsPerInterval[df$Interval %in% ad$interval],ad$steps)

totalStepsPerDay2 <- aggregate(steps~date,ad,sum)
```

4. Histogram of the total number of steps taken each dayof steps taken each day.


```r
hist(totalStepsPerDay2$steps,main = 'Total Steps Per Day',xlab = 'Total Steps',col = 'blue',border = 'orange')
```

![](PA1_template_files/figure-html/histogram2-1.png)<!-- -->

Calculate and report the mean and median total number of steps taken per day.


```r
options(scipen = 5,digits = 2)
mean_totalStepsPerDay2 <- mean(totalStepsPerDay2$steps)
median_totalStepsPerDay2 <- median(totalStepsPerDay2$steps)
```
The mean of the total steps taken per day is: 10766.19.  
The median of the total steps taken per day is: 10766.19.  

Do these values differ from the estimates from the first part of the assignment?  
The median is slightly higher after replacing the NA values with the mean for the 5-minute interval.  

What is the impact of imputing missing data on the estimates of the total daily number of steps?  
Comparing the mean and median generated by using both the missing and imputed data, the impact of imputing the missing values seems minimal. If we look at the observations that are missing steps as a percentage of the whole, we see that:


```r
missingPercentage <- (nbrNA/17568)*100
```

we are only missing about 13 percent of the steps.

## Are there differences in activity patterns between weekdays and weekends?

1. Create a new factor variable for the data set with levels 'weekday' and 'weekend'


```r
ad$TypeOfDay <- ifelse(weekdays(ad$date) %in% c("Saturday", "Sunday"), "weekend", "weekday")
ad$TypeOfDay <- as.factor(ad$TypeOfDay)

ad_weekday <- ad[ad$TypeOfDay == 'weekday',]
ad_weekend <- ad[ad$TypeOfDay == 'weekend',]
x <- aggregate(steps~interval,ad_weekday,mean)
y <- aggregate(steps~interval,ad_weekend,mean)
```

2. Time series plot of the 5-minute interval and the average number of steps taken on weekdays vs. weekends.  


```r
par(mfrow=c(2,1),mar=c(5,2,2,2))
plot(x$interval,x$steps,type = 'l',main = 'Weekday',xlab = 'Interval',ylab = 'Number of steps',ylim = c(0,250))
plot(y$interval,y$steps,type = 'l',main = 'Weekend',xlab = 'Interval',ylab = 'Number of steps',ylim = c(0,250))
```

![](PA1_template_files/figure-html/WeekdayWeekendPlot-1.png)<!-- -->

The plots show that there are more steps taken during the 1000 to 2000 interval on the weekends than during the weekdays.


